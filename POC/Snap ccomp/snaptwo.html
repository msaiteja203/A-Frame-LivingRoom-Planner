<!doctype html>
<html>
 
<head>
    <title>Snap Component</title>
    <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script>
    <!-- <script src="https://rawgit.com/ngokevin/kframe/csstricks/scenes/aincraft/components/random-color.js"></script> -->
    <!-- <script src="https://rawgit.com/ngokevin/kframe/csstricks/scenes/aincraft/components/snap.js"></script> -->
    <script>
        AFRAME.registerComponent('snap', {
            dependencies: ['position'],
 
            schema: {
                offset: { type: 'vec3' },
                snap: { type: 'vec3' }
            },
 
            init: function () {
                this.originalPos = this.el.getAttribute('position');
            },
 
            update: function () {
                var data = this.data;
 
                var pos = AFRAME.utils.clone(this.originalPos);
                pos.x = Math.floor(pos.x / data.snap.x) * data.snap.x + data.offset.x;
                pos.y = Math.floor(pos.y / data.snap.y) * data.snap.y + data.offset.y;
                pos.z = Math.floor(pos.z / data.snap.z) * data.snap.z + data.offset.z;
 
                this.el.setAttribute('position', pos);
            }
        });
        AFRAME.registerComponent('random-color', {
            dependencies: ['material'],
 
            init: function () {
                // Set material component's color property to a random color.
                this.el.setAttribute('material', 'color', getRandomColor());
            }
        });
 
        function getRandomColor() {
            var letters = '0123456789ABCDEF';
            var color = '#';
            for (var i = 0; i < 6; i++) {
                color += letters[Math.floor(Math.random() * 16)];
            }
            return color;
        }</script>
</head>
 
<body>
    <a-scene>
        <a-assets>
            <img id="groundTexture" src="https://cdn.aframe.io/a-painter/images/floor.jpg">
            <img id="skyTexture" src="https://cdn.aframe.io/a-painter/images/sky.jpg">
            <a-mixin id="voxel" geometry="primitive: box; height: 0.5; width: 0.5; depth: 0.5"
                material="shader: standard" random-color snap="offset: 0.25 0.25 0.25; snap: 5 0.5 0.5"></a-mixin>
        </a-assets>
 
        <a-sky id="background" src="#skyTexture" theta-length="90" radius="30"></a-sky>
 
        <a-cylinder id="ground" src="#groundTexture" radius="30" height="0.1"></a-cylinder>
 
        <a-entity mixin="voxel" color="#00AA00" position="0 1 1"></a-entity>
        <a-entity mixin="voxel" color="#AAAA00" position="0 1.25 1"></a-entity>
       <!--  <a-entity mixin="voxel" color="#00AAAA" position="0 1 -2">
            <a-animation attribute="rotation" to="0 360 0" repeat="indefinite"></a-animation>
        </a-entity>
        <a-entity mixin="voxel" color="#AAAAAA" position="1 0 -2"></a-entity>
        <a-entity mixin="voxel" color="#AAAAAA" position="1 0 -2"></a-entity> -->
  <a-entity><a-box color="#AA00AA" position="1 0 -2"></a-box></a-entity>
 
        <a-entity position="0 0 2">
            <a-camera>
                <a-cursor></a-cursor>
            </a-camera>
        </a-entity>
 
    </a-scene>
</body>
 
</html>