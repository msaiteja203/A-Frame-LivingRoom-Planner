<!doctype html>
<html>
<head>
	<title>On-rails dynamic FOV reduction</title>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-animation-component@^4.1.2/dist/aframe-animation-component.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@^4.0.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@2.1.0/dist/super-hands.min.js"></script>
</head>

 <!-- Listen to the movement-controls events 'navigation-start' and 'navigation-end' -->
 <!-- Write and order your code bearing in mind A-Frame's order-dependent rendering -->
 <!-- Modify the FOV Filter Strength by changing the POSITION of the vignette image -->
 <!-- Suggested value range for the Z-axis: min 0; max: -0.3 -->

<body>
    <!-- ******** With A-Frame v1.4.2 you don't need to install the animation component anymore as it is part of the core library ******** -->
    <!-- ******** For the code below, NOTHING HAS CHANGED WITH v1.4.2 ******** -->
	<a-scene background="color: #FFFFFF">
		<!-- Asset Management System -->
		<a-assets>
			<img id="footsteps" src="../L41 - Instant and blink teleportation CODE v1.4.2/L41-ASSETs/footsteps.png">
			<img id="black" src="../L41 - Instant and blink teleportation CODE v1.4.2/L41-ASSETs/black.png">
		</a-assets>

		<!-- Ground -->
		<a-plane color="#DDDDDD" shader="flat" rotation="-90 0 0" scale="10 40 1">
		</a-plane>

		<!-- Curved Image -->
        <a-curvedimage src="../L41 - Instant and blink teleportation CODE v1.4.2/L41-ASSETs/curved-image.jpg" position="-3 1.5 -16" scale="3 3 3"
                       theta-length="90" theta-start="135" radius="0.707" height="0.833">
        </a-curvedimage>
		<!-- Checkpoint UI -->
		<a-image src="#footsteps" position="-3 3.5 -16" checkpoint="offset: 0 -3.5 0"
				  look-at="#cam-rig" class="clickable">
		</a-image>

		<!-- Green Box -->
		<a-box color="#00AA00" position="3 0.5 -16"></a-box>
		<!-- Checkpoint UI -->
		<a-image src="#footsteps" position="3 2.5 -16" checkpoint="offset: -1 -2.5 0"
				 look-at="#cam-rig" class="clickable">
		</a-image>
		
		<!-- Yellow Box -->
		<a-box color="#FFAA00" position="-3 0.5 -8"></a-box>
		<!-- Checkpoint UI -->
		<a-image src="#footsteps" position="-3 2.5 -8" checkpoint="offset: 1 -2.5 0"
				 look-at="#cam-rig" class="clickable">
		</a-image>
		
		<!-- Red Box -->
		<a-box color="#AA0000" position="3 0.5 -8"></a-box>
		<!-- Checkpoint UI -->
		<a-image src="#footsteps" position="3 2.5 -8" checkpoint="offset: -1 -2.5 0"
				 look-at="#cam-rig" class="clickable">
		</a-image>
		
		<!-- Camera Rig -->
		<a-entity id="cam-rig"
			  	    movement-controls="controls: checkpoint"
				      checkpoint-controls="mode: animate"
              event-set__start="_target: #dyn-fov-red; _event: navigation-start;
                                animation.property: opacity;
                                animation.to: 1;
                                animation.dur: 300;
                                animation.easing: easeOutQuad"
              event-set__end="_target: #dyn-fov-red; _event: navigation-end;
                              animation.to: 0">
			<!-- Camera -->
      <a-entity progressive-controls>
       <a-camera>
		<a-image id="dyn-fov-red" src="#black" position="0 0 -0.3" opacity="0">
        </a-image>
	   </a-camera>
      </a-entity>
      <!-- A-FRAME's laser-controls component for VR headsets (Quest, Quest 2, Vive Pro, etc.) -->
      <!-- Right Controller  -->
      <a-entity laser-controls="hand: right" raycaster="objects: .clickable; lineColor: #FF0000"></a-entity>
      <!-- Left Controller  -->
      <a-entity laser-controls="hand: left" raycaster="objects: .clickable; lineColor: #FF0000"></a-entity>
		</a-entity>
	</a-scene>
</body>
</html>